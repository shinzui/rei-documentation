---
title: rei custom-property
description: Define and manage custom properties for entities
icon: SlidersHorizontal
---

Define and manage custom properties that can be attached to entities (intentions, habits, disruptions, notes). Custom properties allow you to extend entities with your own metadata fields.

## Concepts

**Custom Property** — A user-defined property definition with:
- **Key** — Unique identifier (alphanumeric, hyphens, underscores)
- **Label** — Human-readable display name
- **Value type** — The data type for values (int, enum, state-machine, etc.)
- **Entity scope** — Which entity types can have this property
- **Category scope** — Optional restriction to a specific category

**Property Assignment** — Once a property is defined, you can assign values to entities using `rei <entity> set-property` commands.

## Value Types

Custom properties support the following value types:

| Type | Description | Example |
|------|-------------|---------|
| `int` | Integer with optional min/max | effort level (1-10) |
| `float` | Decimal with optional precision | completion percentage |
| `text` | Free text with optional length limits | notes field |
| `bool` | Boolean true/false | is_urgent flag |
| `enum` | Predefined set of values (single-select) | priority (low, medium, high) |
| `label-set` | Predefined set of labels (multi-select) | areas (backend, frontend, security) |
| `duration` | Time duration | estimated time |
| `quantity` | Numeric with units | distance (km, miles) |
| `state-machine` | States with transitions | task workflow |
| `date` | Date (YYYY-MM-DD) | due date |
| `datetime` | Date and time | deadline |
| `path` | File path | reference file |
| `url` | URL | documentation link |
| `note` | Reference to a note entity | spec note, next action note |

## State Machine YAML Format

State machine properties require a YAML configuration file that defines states and transitions. The file is passed via `--from-file` when creating the property.

**Basic Structure:**

```yaml
initialState: backlog        # Required: state to assign when no value exists
states:                      # Required: at least one state
  - stateId: backlog
    stateLabel: "Backlog"
    stateDescription: "Items waiting to be picked up"  # Optional
    stateTags:               # Optional: semantic tags for querying
      - systemTag: TagQueue
    stateColor: "#808080"    # Optional: hex color for UI
  - stateId: in-progress
    stateLabel: "In Progress"
    stateTags:
      - systemTag: TagActive
  - stateId: done
    stateLabel: "Done"
    stateTags:
      - systemTag: TagDone
      - systemTag: TagTerminal
transitions:                 # Required: defines allowed state changes
  - transitionFrom: backlog
    transitionTo: in-progress
    transitionLabel: "Start"  # Optional
  - transitionFrom: in-progress
    transitionTo: done
    transitionLabel: "Complete"
  - transitionFrom: in-progress
    transitionTo: backlog
    transitionLabel: "Move back"
```

**System Tags:**

System tags provide semantic meaning for queries and UI:

| Tag | Description |
|-----|-------------|
| `TagQueue` | Items waiting to be worked on |
| `TagActive` | Items currently in progress |
| `TagDone` | Items that are complete |
| `TagTerminal` | Final states (no further transitions) |

**Custom Tags:**

You can also define custom tags for your own categorization:

```yaml
stateTags:
  - userTag: "needs-review"
  - userTag: "blocked-external"
```

**Example: Kanban Workflow**

```yaml
# kanban.yaml
initialState: backlog
states:
  - stateId: backlog
    stateLabel: "Backlog"
    stateTags:
      - systemTag: TagQueue
  - stateId: ready
    stateLabel: "Ready"
    stateTags:
      - systemTag: TagQueue
  - stateId: in-progress
    stateLabel: "In Progress"
    stateTags:
      - systemTag: TagActive
  - stateId: review
    stateLabel: "In Review"
    stateTags:
      - systemTag: TagActive
      - userTag: "needs-review"
  - stateId: done
    stateLabel: "Done"
    stateTags:
      - systemTag: TagDone
      - systemTag: TagTerminal
  - stateId: cancelled
    stateLabel: "Cancelled"
    stateTags:
      - systemTag: TagTerminal
transitions:
  - transitionFrom: backlog
    transitionTo: ready
    transitionLabel: "Groom"
  - transitionFrom: ready
    transitionTo: in-progress
    transitionLabel: "Start"
  - transitionFrom: in-progress
    transitionTo: review
    transitionLabel: "Submit for review"
  - transitionFrom: review
    transitionTo: in-progress
    transitionLabel: "Request changes"
  - transitionFrom: review
    transitionTo: done
    transitionLabel: "Approve"
  - transitionFrom: backlog
    transitionTo: cancelled
    transitionLabel: "Cancel"
  - transitionFrom: ready
    transitionTo: cancelled
    transitionLabel: "Cancel"
  - transitionFrom: in-progress
    transitionTo: cancelled
    transitionLabel: "Cancel"
```

Create the property with:

```bash
rei custom-property create workflow \
  --type-state-machine --from-file kanban.yaml \
  -e intention \
  --label "Workflow Status"
```

## Subcommands

### create

Create a new custom property definition.

```bash
rei custom-property create KEY [options] --type-<TYPE> [type-options]
```

**Arguments:**
- `KEY` — Property key (alphanumeric, hyphens, underscores)

**Options:**
- `-l, --label <label>` — Human-readable label (defaults to key)
- `-d, --description <desc>` — Property description
- `-e, --entity-type <type>` — Entity type to apply to (can be repeated). Valid types: intention, habit, disruption, note
- `-c, --category <slug>` — Scope to a specific category (must be a leaf category with no children)
- `--actor <actor>` — Actor performing this action (overrides global `--actor`)

**Type Flags (pick one):**

- `--type-int` — Integer type
  - `--min <N>` — Minimum value
  - `--max <N>` — Maximum value

- `--type-float` — Float type
  - `--min <N>` — Minimum value
  - `--max <N>` — Maximum value
  - `--precision <N>` — Decimal precision

- `--type-text` — Text type
  - `--min-length <N>` — Minimum length
  - `--max-length <N>` — Maximum length

- `--type-bool` — Boolean type

- `--type-enum` — Enum type (single-select)
  - `--values <val1,val2,...>` — Comma-separated enum values (required)

- `--type-label-set` — Label set type (multi-select)
  - `--labels <label1,label2,...>` — Comma-separated labels (required)

- `--type-duration` — Duration type

- `--type-quantity` — Quantity type (numeric with units)
  - `--base-unit <unit>` — Base storage unit (required)
  - `--allowed-units <u1,u2,...>` — Comma-separated allowed units (required)
  - `--display-unit <unit>` — Preferred display unit

- `--type-state-machine` — State machine type
  - `--from-file <file>` — YAML file defining states and transitions (required)

- `--type-date` — Date type (YYYY-MM-DD)

- `--type-datetime` — DateTime type

- `--type-path` — File path type
  - `--must-exist` — Path must exist at assignment time
  - `--must-be-directory` — Path must be a directory
  - `--must-be-file` — Path must be a file
  - `--must-be-absolute` — Path must be absolute

- `--type-url` — URL type
  - `--allowed-schemes <s1,s2,...>` — Comma-separated allowed schemes
  - `--allowed-hosts <h1,h2,...>` — Comma-separated allowed hosts

- `--type-note` — Note reference type (value is a note ID)

**Examples:**

```bash
# Create a priority enum property for intentions
rei custom-property create priority \
  --type-enum --values low,medium,high \
  -e intention

# Create an effort int property for intentions and habits
rei custom-property create effort \
  --type-int --min 1 --max 10 \
  -e intention -e habit \
  --label "Effort Level" \
  --description "Estimated effort from 1 (trivial) to 10 (massive)"

# Create a severity enum for disruptions
rei custom-property create severity \
  --type-enum --values low,medium,high,critical \
  -e disruption

# Create a label-set property for tagging areas (multi-select)
rei custom-property create areas \
  --type-label-set --labels backend,frontend,security,devops \
  -e intention \
  --label "Work Areas"

# Create a state machine property from YAML config
rei custom-property create task-state \
  --type-state-machine --from-file task-states.yaml \
  -e intention

# Create a note reference property for cross-referencing
rei custom-property create spec \
  --type-note \
  -e intention

# Create a text property scoped to a category
rei custom-property create client-notes \
  --type-text --max-length 1000 \
  -e intention \
  -c work
```

**Notes:**
- Category scope (`-c`) requires a leaf category (one with no children). This ensures properties are assigned at the most specific level.

### list

List custom property definitions.

```bash
rei custom-property list [options]
```

**Options:**
- `-a, --all` — Include archived properties
- `-c, --category <slug>` — Filter by category scope
- `-e, --entity-type <type>` — Filter by entity type

**Examples:**

```bash
# List all active properties
rei custom-property list

# List properties for intentions only
rei custom-property list -e intention

# Include archived properties
rei custom-property list --all

# Filter by category scope
rei custom-property list -c work
```

### show

Show details of a custom property.

```bash
rei custom-property show [KEY] [options]
```

**Arguments:**
- `[KEY]` — Property key or ID (optional if fzf is available)

**Options:**
- `--with-counts` — Include entity counts per state (state machine properties only)
- `-c, --category <slug>` — Category scope for disambiguation when multiple properties have the same key

> **FZF Support:** If the key is not provided and [fzf](https://github.com/junegunn/fzf) is installed, an interactive picker will let you select from available properties.

**Examples:**

```bash
# Show property details
rei custom-property show priority

# Use FZF to select
rei custom-property show

# Show state machine property with entity counts per state
rei custom-property show workflow --with-counts

# Show category-scoped property (when key exists in multiple categories)
rei custom-property show workflow --category work
```

**Notes:**
- The `--with-counts` flag shows the number of entities currently in each state, useful for tracking WIP limits

### archive

Archive a custom property (soft delete).

```bash
rei custom-property archive KEY [options]
```

**Arguments:**
- `KEY` — Property key or ID

**Options:**
- `-c, --category <slug>` — Category scope for disambiguation when multiple properties have the same key

**Examples:**

```bash
# Archive a property
rei custom-property archive old-priority

# Archive a category-scoped property (when key exists in multiple categories)
rei custom-property archive workflow --category work
```

**Notes:**
- Archived properties are hidden from lists by default
- Existing property assignments are preserved
- Use `list --all` to see archived properties

### relabel

Update the display label of a custom property.

```bash
rei custom-property relabel KEY NEW_LABEL [options]
```

**Arguments:**
- `KEY` — Property key or ID
- `NEW_LABEL` — New display label

**Options:**
- `-c, --category <slug>` — Category scope for disambiguation when multiple properties have the same key

**Examples:**

```bash
# Relabel a property
rei custom-property relabel priority "Priority Level"

# Relabel a category-scoped property (when key exists in multiple categories)
rei custom-property relabel workflow "Work Workflow" --category work
```

**Notes:**
- Property keys are immutable; only the label can be changed
- Use labels for human-readable display names

### set-scope

Update property scope (entity types and category).

```bash
rei custom-property set-scope KEY [options]
```

**Arguments:**
- `KEY` — Property key or ID

**Options:**
- `-e, --entity-type <type>` — Entity type (can be repeated to set multiple)
- `-c, --category <slug>` — Category scope
- `--clear-category` — Remove category scope (make global)

**Examples:**

```bash
# Add habit to entity types
rei custom-property set-scope priority -e intention -e habit

# Scope to a specific category
rei custom-property set-scope client-notes -c work

# Remove category scope
rei custom-property set-scope client-notes --clear-category
```

## State Machine Evolution

State machine properties can be evolved after creation using these commands.

### add-state

Add a state to a state machine property.

```bash
rei custom-property add-state KEY STATE_ID --label LABEL [options]
```

**Arguments:**
- `KEY` — Property key or ID
- `STATE_ID` — State identifier (lowercase, hyphens/underscores)

**Options:**
- `-l, --label <label>` — Human-readable state label (required)
- `-d, --description <desc>` — State description
- `-t, --tag <tag>` — State tag (can be repeated). Common tags: queue, active, done, terminal
- `-o, --order <N>` — Display order (lower numbers shown first)

**Examples:**

```bash
# Add a new state
rei custom-property add-state task-state blocked --label "Blocked" -t active

# Add a terminal state
rei custom-property add-state task-state cancelled --label "Cancelled" -t terminal

# Add a state with display order
rei custom-property add-state task-state review --label "In Review" -t active --order 2
```

### remove-state

Remove a state from a state machine property.

```bash
rei custom-property remove-state KEY STATE_ID
```

**Arguments:**
- `KEY` — Property key or ID
- `STATE_ID` — State identifier to remove

**Examples:**

```bash
# Remove a state
rei custom-property remove-state task-state blocked
```

**Notes:**
- Cannot remove states that are currently in use by entities
- Transitions involving the state are also removed

### update-state-order

Update the display order of a state in a state machine property.

```bash
rei custom-property update-state-order KEY STATE_ID [options]
```

**Arguments:**
- `KEY` — Property key or ID
- `STATE_ID` — State identifier to update

**Options:**
- `-o, --order <N>` — Display order (lower numbers shown first). Omit to clear the order.

**Examples:**

```bash
# Set display order for a state
rei custom-property update-state-order task-state in-progress --order 1

# Clear display order (state will sort by ID)
rei custom-property update-state-order task-state in-progress
```

**Notes:**
- States with display order are shown first (sorted by order)
- States without display order are shown after (sorted alphabetically by ID)
- Display order affects CLI output and grouped intention lists

### add-transition

Add a transition between states.

```bash
rei custom-property add-transition KEY FROM_STATE TO_STATE [options]
```

**Arguments:**
- `KEY` — Property key or ID
- `FROM_STATE` — Source state ID
- `TO_STATE` — Target state ID

**Options:**
- `-l, --label <label>` — Transition label

**Examples:**

```bash
# Add a transition
rei custom-property add-transition task-state todo in-progress --label "Start"

# Add reverse transition
rei custom-property add-transition task-state in-progress todo --label "Revert"
```

### remove-transition

Remove a transition between states.

```bash
rei custom-property remove-transition KEY FROM_STATE TO_STATE
```

**Arguments:**
- `KEY` — Property key or ID
- `FROM_STATE` — Source state ID
- `TO_STATE` — Target state ID

**Examples:**

```bash
# Remove a transition
rei custom-property remove-transition task-state todo blocked
```

### set-state-limit

Set a WIP (Work In Progress) limit on a state machine state.

```bash
rei custom-property set-state-limit KEY --state STATE_ID --limit N
```

**Arguments:**
- `KEY` — Property key or ID

**Options:**
- `-s, --state <state_id>` — State identifier to set limit on (required)
- `-l, --limit <N>` — Maximum entities allowed in this state (required)

**Examples:**

```bash
# Set a WIP limit of 3 on the in-progress state
rei custom-property set-state-limit workflow --state in-progress --limit 3

# Set a limit on a category-scoped property
rei custom-property set-state-limit workflow --state in-progress --limit 5 --category work
```

**Notes:**
- WIP limits are advisory — they show warnings but don't block transitions
- Use `--with-counts` on `show` command to see current entity counts per state

### clear-state-limit

Remove a WIP limit from a state machine state.

```bash
rei custom-property clear-state-limit KEY --state STATE_ID
```

**Arguments:**
- `KEY` — Property key or ID

**Options:**
- `-s, --state <state_id>` — State identifier to clear limit from (required)

**Examples:**

```bash
# Remove the WIP limit from a state
rei custom-property clear-state-limit workflow --state in-progress
```

### metrics

View state machine transition metrics and workflow analytics.

```bash
rei custom-property metrics [KEY] [options]
```

**Arguments:**
- `[KEY]` — Property key or ID (state machine properties only, optional if fzf is available)

**Options:**
- `-d, --detailed` — Show detailed breakdown by entity
- `-c, --category <slug>` — Category scope for disambiguation when multiple properties have the same key

**Examples:**

```bash
# View metrics for a state machine property
rei custom-property metrics workflow

# View detailed metrics with entity breakdown
rei custom-property metrics workflow --detailed

# View metrics for category-scoped property
rei custom-property metrics workflow --category work
```

**Notes:**
- Metrics show current state distribution with entity counts
- Average time in each state
- Recent transitions (last 7 days)

## Enum Evolution

Enum properties can be evolved after creation using these commands.

### add-enum-value

Add a value to an enum property.

```bash
rei custom-property add-enum-value KEY VALUE
```

**Arguments:**
- `KEY` — Property key or ID
- `VALUE` — Enum value to add

**Examples:**

```bash
# Add a new priority level
rei custom-property add-enum-value priority critical
```

### remove-enum-value

Remove a value from an enum property.

```bash
rei custom-property remove-enum-value KEY VALUE
```

**Arguments:**
- `KEY` — Property key or ID
- `VALUE` — Enum value to remove

**Examples:**

```bash
# Remove an enum value
rei custom-property remove-enum-value priority low
```

**Notes:**
- Cannot remove values that are currently in use by entities

## LabelSet Evolution

LabelSet properties can be evolved after creation using these commands.

### add-label

Add a label to a label-set property.

```bash
rei custom-property add-label KEY LABEL
```

**Arguments:**
- `KEY` — Property key or ID
- `LABEL` — Label to add

**Examples:**

```bash
# Add a new area label
rei custom-property add-label areas infrastructure
```

### remove-label

Remove a label from a label-set property.

```bash
rei custom-property remove-label KEY LABEL
```

**Arguments:**
- `KEY` — Property key or ID
- `LABEL` — Label to remove

**Examples:**

```bash
# Remove a label
rei custom-property remove-label areas legacy
```

**Notes:**
- Cannot remove labels that are currently in use by entities
- Cannot remove the last label from a label-set

## Using Properties

Once properties are defined, assign values to entities:

```bash
# Set a property on an intention
rei intention set-property intention_01abc... priority high

# Set a label-set property (multiple labels, comma-separated)
rei intention set-property intention_01abc... areas backend,security

# Set a property on a habit
rei habit set-property habit_01abc... effort 5

# Set a property on a disruption
rei disruption set-property redis-timeouts severity critical

# Clear a property from an intention
rei intention clear-property intention_01abc... priority
```

## Filtering by Properties

Use the `--where` flag to filter entity lists by property values:

```bash
# Filter intentions by priority
rei intention list --where priority=high

# Filter by numeric comparison
rei intention list --where "effort>=5"

# Filter habits by effort
rei habit list --where "effort<3"
```

### LabelSet Filtering

LabelSet properties support two special operators for filtering:

- `any` — Match entities that have **any** of the specified labels
- `all` — Match entities that have **all** of the specified labels

```bash
# Find intentions with any of the specified areas
rei intention list --where "areas any backend,frontend"

# Find intentions that have all specified areas
rei intention list --where "areas all backend,security"

# Works with disruptions too
rei disruption list --where "impact-areas any infrastructure,api"
```

See [`rei intention list`](/docs/commands/intention), [`rei habit list`](/docs/commands/habit), and [`rei disruption list`](/docs/commands/disruption) for more filtering options.

## Automatic Initialization

### init-entities

Retroactively initialize a state machine property for entities that have the matching category but don't have a value set.

```bash
rei custom-property init-entities KEY [options]
```

**Arguments:**
- `KEY` — Property key of the state machine property to initialize

**Options:**
- `-n, --dry-run` — Show what would be done without making changes

**Examples:**

```bash
# Preview what would be initialized
rei custom-property init-entities task-state --dry-run

# Initialize all matching entities
rei custom-property init-entities task-state
```

**Notes:**
- Only works with state machine properties that are scoped to a category
- Only initializes entities that belong to the property's scoped category
- Skips entities that already have a value for this property
- Sets the property to the state machine's `initialState`

**Automatic Initialization:**

State machine properties scoped to a category are automatically initialized when:
1. A category is assigned to an entity via `rei intention set-category` (or similar)
2. The category has state machine properties scoped to it
3. The entity doesn't already have a value for those properties

The `init-entities` command is useful for retroactively initializing existing entities that were created before the property was defined.

## Category-Scoped Property Keys

The same property key can exist in different categories with different configurations. This allows category-specific workflows while using consistent property names.

### Creating Properties with Same Key in Different Categories

```bash
# Create a workflow property for work category
rei custom-property create workflow \
  --type-state-machine --from-file work-kanban.yaml \
  -e intention -c work

# Create a workflow property for personal category with different states
rei custom-property create workflow \
  --type-state-machine --from-file personal-kanban.yaml \
  -e intention -c personal
```

### Automatic Resolution

When assigning properties to entities, the system automatically resolves the correct property based on the entity's category:

```bash
# Sets the work workflow property (automatic resolution)
rei intention set-property intention_01abc... workflow in-progress
```

### Disambiguation with --category

When viewing or modifying properties with duplicate keys, use `--category` to specify which one:

```bash
# Show the work version of workflow
rei custom-property show workflow --category work

# Show metrics for personal workflow
rei custom-property metrics workflow --category personal

# Relabel the work version
rei custom-property relabel workflow "Work Pipeline" --category work
```

### Key Uniqueness Rules

- **Global properties** — key must be unique among all global properties
- **Category-scoped** — key + category combination must be unique
- The same key CAN exist in different categories

## State Rules

State rules require specific property values before an entity can transition into a state. See the [State Machine Properties Guide](/docs/guides/state-machines) for full documentation.

**Key behavior:** When adding a state rule with a boolean value (e.g., `--require deploy-ready=true`), if the referenced property doesn't exist, it is automatically created as a boolean property inheriting the state machine's scope. This eliminates the need to manually create boolean gate properties.

```bash
# This auto-creates "deploy-ready" as a bool property if it doesn't exist
rei custom-property add-state-rule workflow \
  --state production --require deploy-ready=true
```

## Related Commands

- [`rei intention set-property`](/docs/commands/intention) — Set properties on intentions
- [`rei habit set-property`](/docs/commands/habit) — Set properties on habits
- [`rei disruption set-property`](/docs/commands/disruption) — Set properties on disruptions
- [`rei category`](/docs/commands/category) — Manage categories for scoping properties
- [`rei help state-machines`](/docs/guides/state-machines) — Detailed help for state machine properties
